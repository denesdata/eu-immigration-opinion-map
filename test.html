<p>
    SirFizX
</p>
<div id="bar-demo"></div>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>

<p>
    Google Sheets Visualization
</p>
<script>
    // forked from _shimizu's "D3.js + Googleスプレッドシート" http://jsdo.it/_shimizu/zemk

    google.load("visualization", "1");
    google.setOnLoadCallback(init);

    var GSheetID = '1rOk6EEUDPwJ-5OczQiO9u70YBNip-kVSDv7VPoMhX-Q'
    var GSheetName = 'Data'
    var n_col = 12 //data.getNumberOfColumns();
    var DataArray;


    function init() {
        var query = new
        google.visualization.Query("https://docs.google.com/spreadsheet/ccc?key=" + GSheetID +'&sheet='+GSheetName);
        //query.setQuery("select *  where B > 2  ");
        query.setQuery("");
        query.send(handleQueryResponse);
    }

    function handleQueryResponse(response) {
        var data = response.getDataTable();
        //var headers = response.getHeaders();
        DataArray = new Array(data.getNumberOfRows());
        for (var row = 0; row < data.getNumberOfRows(); row++) {
            DataArray[row] = new Array(data.getNumberOfColumns());
            for (var col = 0; col < n_col; col++) {
                DataArray[row][col] = data.getValue(row, col);
            }
        }
        console.log(DataArray,data)
    }


    
</script>