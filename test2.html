<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script>
    // forked from _shimizu's "D3.js + Googleスプレッドシート" http://jsdo.it/_shimizu/zemk

    google.load("visualization", "1");
    google.setOnLoadCallback(init);

    function init() {

        var GSheetID = '1rOk6EEUDPwJ-5OczQiO9u70YBNip-kVSDv7VPoMhX-Q'
        var GSheetName = 'Data'
        var n_col = 12 //data.getNumberOfColumns();
        var query_type = 'data'
        var all_data = [];

        function data_lists_to_object_array(data) {
            var dummy = [];
            var keys = data[0]
            for (i = 1; i < data.length; i++) {
                var d = []
                for (j = 0; j < keys.length; j++) {
                    d[keys[j]] = data[i][j];
                }
                dummy.push(d);
            }
            return dummy
        }

        function data_to_lists(ColumnNames, DataArray) {
            return [ColumnNames].concat(DataArray)
        }

        var query1 = new
        google.visualization.Query("https://docs.google.com/spreadsheet/ccc?key=" + GSheetID + '&sheet=' + GSheetName);
        //query.setQuery("select *  where B > 2  ");
        query1.setQuery("");
        query1.send(handleQueryResponse1);

        function handleQueryResponse1(response) {
            var data = response.getDataTable();
            var ColumnNames = []
            var DataArray = new Array(data.getNumberOfRows());

            for (var col = 0; col < n_col; col++) {
                ColumnNames.push(data.getColumnLabel(col))
            }
            for (var row = 0; row < data.getNumberOfRows(); row++) {
                DataArray[row] = new Array(n_col);
                for (var col = 0; col < n_col; col++) {
                    DataArray[row][col] = data.getValue(row, col);
                }
            }

            all_data[query_type] = data_to_lists(ColumnNames, DataArray)

            GSheetID = '1rOk6EEUDPwJ-5OczQiO9u70YBNip-kVSDv7VPoMhX-Q'
            GSheetName = 'Params'
            query_type = 'params'
            n_col = 2 //data.getNumberOfColumns();
            var query2 = new
            google.visualization.Query("https://docs.google.com/spreadsheet/ccc?key=" + GSheetID + '&sheet=' +
                GSheetName);
            query2.setQuery("");
            query2.send(handleQueryResponse2);

            function handleQueryResponse2(response) {
                var data = response.getDataTable();
                var ColumnNames = []
                var DataArray = new Array(data.getNumberOfRows());

                for (var col = 0; col < n_col; col++) {
                    ColumnNames.push(data.getColumnLabel(col))
                }
                for (var row = 0; row <
                    data.getNumberOfRows(); row++) {
                    DataArray[row] = new Array(n_col);
                    for (var col = 0; col < n_col; col++) {
                        DataArray[row][col] = data.getValue(row, col);
                    }
                }

                all_data[query_type] = DataArray

                var params = all_data['params'];
                var data = all_data['data'];

                //data_lists_to_object_array(data))

                

            }

        }

    }
</script>