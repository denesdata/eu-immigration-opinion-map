<!DOCTYPE html>
<html style="height: 100%">

<head>
    <meta charset="utf-8">
</head>

<body style="height: 100%; margin: 0">
    <div id="container" style="height: 100%"></div>
    <script type="text/javascript" src="echarts.min.js"></script>
    <script src="d3-fetch.v1.min.js"></script>
    <script src="d3-dsv.v1.min.js"></script>
    <!-- <script src="https://d3js.org/d3-selection.v1.min.js"></script> -->
    <script type="text/javascript">
        function percentageFormatter(d){
            return +d.replace('%','')
        }
        function getKeyValues(d,key){
            var dummy=[];
            for (i=0;i<d.length;i++){
                dummy.push(d[i][key])
            }
            return dummy
        }
        d3.dsv(",","data.csv", function(d) {
            //make numbers positve, change labels if needed
            d['Conversation size']=percentageFormatter(d['Conv. size'])
            d['Demographics']=percentageFormatter(d['Demographics'])
            d['Domestic politics']=percentageFormatter(d['Domestic politics'])
            d['EU politics']=percentageFormatter(d['EU politics'])
            d['Economy']=percentageFormatter(d['Economy'])
            d['Humanitarianism']=percentageFormatter(d['Humanitarianism'])
            d['Identity & Customs']=percentageFormatter(d['Identity & Customs'])
            d['Securitization']=percentageFormatter(d['Securitization'])
            d['Refugee percent']=percentageFormatter(d['refugee percent'])
            return d
            }).then(function(data) {
            
            console.log(data)
            console.log(getKeyValues(data,'Securitization'))
            var dom = document.getElementById("container");
            var myChart = echarts.init(dom);
            var app = {};
            option = {
                yAxis: {
                    type: 'category',
                    data: getKeyValues(data,'Country name'),
                    inverse: true
                },
                xAxis: {
                    type: 'value'
                },
                series: [{
                    data: getKeyValues(data,'Securitization'),
                    type: 'bar'
                }],
                tooltip: {
                    trigger: 'item',
                    formatter: "{b}: {c}"
                }
            };
            ;
            if (option && typeof option === "object") {
                myChart.setOption(option, true);
            }
        })
    </script>
</body>

</html>